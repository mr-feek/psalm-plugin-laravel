<?php

namespace Illuminate\Database\Eloquent;

/**
 * @template TModel of Model
 */
class Builder
{
    /** @psalm-return TModel */
    public function getModel();

    /**
     * @param array<string, mixed> $attributes
     * @psalm-return TModel
     */
    public function create(array $attributes = []);

    /**
     * Create a collection of models from plain arrays.
     *
     * @param  array<mixed>  $items
     * @psalm-return \Illuminate\Database\Eloquent\Collection<TModel>
     */
    public function hydrate(array $items);

    /**
     * Create a collection of models from a raw query.
     *
     * @param  string  $query
     * @param  array<mixed>  $bindings
     * @psalm-return \Illuminate\Database\Eloquent\Collection<TModel>
     */
    public function fromQuery($query, $bindings = []);

    /**
     * Find a model by its primary key.
     *
     * @param  mixed  $id
     * @param  array<int, mixed>  $columns
     * @psalm-return TModel|\Illuminate\Database\Eloquent\Collection<TModel>|null
     */
    public function find($id, $columns = ['*']);

    /**
     * Find multiple models by their primary keys.
     *
     * @param  \Illuminate\Contracts\Support\Arrayable|array<mixed>  $ids
     * @param  array<mixed>  $columns
     * @psalm-return \Illuminate\Database\Eloquent\Collection<TModel>
     */
    public function findMany($ids, $columns = ['*']);

    /**
     * Find a model by its primary key or throw an exception.
     *
     * @param  mixed  $id
     * @param  array<int, mixed>  $columns
     * @psalm-return TModel|\Illuminate\Database\Eloquent\Collection<TModel>
     *
     * @throws \Illuminate\Database\Eloquent\ModelNotFoundException
     */
    public function findOrFail($id, $columns = ['*']);

    /**
     * Find a model by its primary key or return fresh model instance.
     *
     * @param  mixed  $id
     * @param  array<int, mixed>  $columns
     * @psalm-return TModel
     */
    public function findOrNew($id, $columns = ['*']);

    /**
     * Get the first record matching the attributes or instantiate it.
     *
     * @param  array<mixed>  $attributes
     * @param  array<mixed>  $values
     * @psalm-return TModel
     */
    public function firstOrNew(array $attributes = [], array $values = []);

    /**
     * Get the first record matching the attributes or create it.
     *
     * @param  array<mixed>  $attributes
     * @param  array<mixed>  $values
     * @psalm-return TModel
     */
    public function firstOrCreate(array $attributes, array $values = []);

    /**
     * Create or update a record matching the attributes, and fill it with values.
     *
     * @param  array<mixed>  $attributes
     * @param  array<mixed>  $values
     * @psalm-return TModel
     */
    public function updateOrCreate(array $attributes, array $values = []);

    /**
     * Execute the query and get the first result or throw an exception.
     *
     * @param  array<int, string>  $columns
     * @psalm-return TModel
     *
     * @throws \Illuminate\Database\Eloquent\ModelNotFoundException
     */
    public function firstOrFail($columns = ['*']);

    /**
     * Execute the query and get the first result or call a callback.
     *
     * @param  \Closure|array<int, string>  $columns
     * @param  \Closure|null  $callback
     * @psalm-return TModel|mixed
     */
    public function firstOr($columns = ['*'], \Closure $callback = null);

    /**
     * Execute the query as a "select" statement.
     *
     * @param  array<int, string>|string  $columns
     * @psalm-return \Illuminate\Database\Eloquent\Collection<TModel>
     */
    public function get($columns = ['*']);

    /**
     * Get the hydrated models without eager loading.
     *
     * @param  array<int, string>|string  $columns
     * @psalm-return TModel[]
     */
    public function getModels($columns = ['*']);
}
